---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown] Notebook examining media house value (medv) per the example in Chapter 3.6.2 of "An Introduction to Statistical Learning" (James, Witten, Hastie & Tibshirani).

First, we read in the required libraries: MASS and ISLR.  ISLR contains the datasets used in the aforementioned textbook. 

```{r}
library(MASS)
library(ISLR)
```

We are going to try to predict median home value using 13 predictors in the "Boston" dataset from the MASS library.  We use the fix command to fix the dataset, and then use the "names" function to retrieve the feature names.

```{r}
fix(Boston)
names(Boston)
```


We start by performing a linear (least squares) regression using the lm() function. We first create a model using lstat (the % households with a low socioeconomic status) as the sole predictor.

```{r}
lm.fit=lm(medv~lstat, data=Boston)
#print out some of the basic info about the model lm.fit
lm.fit
```

To get more information about this model, we do the following:

```{r}
summary(lm.fit)
```

We can find the details about what pieces of information are in the lm.fit object by calling the names() function again:

```{r}
names(lm.fit)
```

We can access any of these features using the notation lmfit$feature.  For example:

```{r}
lm.fit$coefficients
```

Observe the confidence intervals on the model's intercept and slope using the confint() function:

```{r}
confint(lm.fit)
```

Furthermore, we can use the lm.fit model to make a prediction based on specified lstat values.  For example,

```{r}
lstat_test = c(5,10,15)
predict(lm.fit, data.frame(lstat_test), interval="confidence")
```

We can also plot the data:
```{r}
plot(Boston$lstat,Boston$medv) #scatterplot of the data
abline(lm.fit) #draws the least squares line
```

```{r}
#add some color to the plot
percentage_low_socioeconomic_households = Boston$lstat
median_home_value = Boston$medv
plot(percentage_low_socioeconomic_households,median_home_value, col="red", pch=20) #scatterplot of the data
abline(lm.fit, lwd=3) #draws the least squares line
```

Next, we take a look at some diagnostic plots associated with the model lm.fit:

```{r}
par(mfrow=c(2,2))
plot(lm.fit)
```
We observe some non-linearity in this model based on the residuals plot (it is curved, not flat and evenly distributed). Next, we will try to improve the linear model by incorporating additional features. That will be in the next session.

```{r}
plot(hatvalues(lm.fit))
which.max(hatvalues(lm.fit))
```
Let's add in the age independent variable to make a model with two predictors.
```{r}
lm.fit = lm(medv~lstat+age, data=Boston)
summary(lm.fit)
```
